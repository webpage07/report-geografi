<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Laporan Nilai Siswa Geografi</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to right, #eef2f3, #8e9eab);
    margin: 0;
    padding: 20px;
  }

  h2 {
    text-align: center;
    color: #2c3e50;
    margin-bottom: 20px;
  }

  .container {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  }

  input[type="text"] {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 8px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    text-align: center;
    font-size: 14px;
  }

  th, td {
    padding: 10px;
    border: 1px solid #ccc;
  }

  th {
    background: #34495e;
    color: white;
    cursor: pointer;
  }

  tr:nth-child(even) {
    background: #f2f2f2;
  }

  tr:hover {
    background: #dfe6e9;
  }

  .footer {
    margin-top: 20px;
    text-align: center;
    color: #555;
    font-size: 13px;
  }
</style>
</head>
<body>
  <h2>Laporan Nilai Siswa Geografi</h2>
  <div class="container">
    <input type="text" id="searchInput" placeholder="🔍 Cari berdasarkan NISN atau Nama...">

    <table id="nilaiTable">
      <thead>
        <tr>
          <th>NISN</th>
          <th>NAMA</th>
          <th>KELAS</th>
          <th>Tugas 1 Konsep Geografi</th>
          <th>Tugas 2 Diagram Cabang Ilmu Geografi</th>
          <th>Tugas 3 Contoh Prinsip Geografi</th>
          <th>Tugas 4 Perkembangan Ilmu Geografi</th>
          <th>Catatan Dasar Geografi</th>
          <th>Sumatif harian 1 Dasar Geografi</th>
          <th>Tugas 5 Analisis Komponen Peta Topografi dan Persebaran Industri</th>
          <th>Tugas 6 Menghitung Skala Peta</th>
          <th>Tugas 7 Menghitung Skala Foto Udara</th>
          <th>Tugas 8 Manfaat SIG</th>
          <th>Catatan Peta, Pengindraan Jauh, SIG</th>
          <th>Sumatif harian 2 Peta PJ SIG</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <tr><td colspan="15">Memuat data...</td></tr>
      </tbody>
    </table>
  </div>

  <div class="footer">
    © 2025 Sistem Nilai Online Geografi — Designed by Ali Imron
  </div>

<script>
  const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ5-YH4IRwxf6aAIG6zyT_XFa-CD9ev60Bs0iF_GZ60aovblWb2LMdtZCkpKYs_DOxG7xciQmROdfYN/pub?gid=772414065&single=true&output=csv";

  async function loadData() {
    const response = await fetch(sheetURL);
    const data = await response.text();
    const rows = data.split("\n").map(r => r.split(","));
    const tableBody = document.getElementById("tableBody");
    tableBody.innerHTML = "";

    for (let i = 1; i < rows.length; i++) {
      const cols = rows[i];
      if (cols.length < 3) continue;
      const tr = document.createElement("tr");
      cols.forEach(c => {
        const td = document.createElement("td");
        td.textContent = c.trim();
        tr.appendChild(td);
      });
      tableBody.appendChild(tr);
    }
  }

  // Fitur pencarian
  document.getElementById("searchInput").addEventListener("keyup", function() {
    const value = this.value.toLowerCase();
    const rows = document.querySelectorAll("#tableBody tr");
    rows.forEach(row => {
      const text = row.textContent.toLowerCase();
      row.style.display = text.includes(value) ? "" : "none";
    });
  });

  // Muat data saat halaman dibuka
  loadData();
</script>
</body>
</html>
