<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Laporan Nilai Geografi</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, sans-serif;
        background: linear-gradient(to right, #b2fefa, #0ed2f7);
        margin: 0;
        padding: 0;
    }
    .container {
        max-width: 1100px;
        margin: 60px auto;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        padding: 30px;
    }
    h2 {
        text-align: center;
        color: #006699;
        margin-bottom: 20px;
    }
    #loginBox {
        text-align: center;
    }
    input[type="text"] {
        padding: 10px;
        width: 250px;
        border-radius: 8px;
        border: 1px solid #888;
        margin-top: 10px;
    }
    button {
        padding: 10px 25px;
        margin-top: 10px;
        background-color: #0099cc;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: 0.3s;
    }
    button:hover {
        background-color: #0077aa;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 25px;
    }
    th, td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: center;
        font-size: 14px;
    }
    th {
        background-color: #0099cc;
        color: white;
        position: sticky;
        top: 0;
    }
    tr:nth-child(even) {
        background-color: #f5f5f5;
    }
    #logoutBtn {
        background-color: #e74c3c;
    }
    #logoutBtn:hover {
        background-color: #c0392b;
    }
    .hidden {
        display: none;
    }
</style>
</head>
<body>
<div class="container">
    <h2>Laporan Nilai Geografi</h2>

    <div id="loginBox">
        <p>Masukkan NISN untuk melihat laporan nilai:</p>
        <input type="text" id="nisnInput" placeholder="Masukkan NISN Anda">
        <br>
        <button onclick="login()">Login</button>
        <p id="loginError" style="color:red;display:none;">‚ùå NISN tidak terdaftar!</p>
    </div>

    <div id="reportBox" class="hidden">
        <button id="logoutBtn" onclick="logout()">Logout</button>
        <table id="nilaiTable">
            <thead>
                <tr>
                    <th>NISN</th>
                    <th>Nama</th>
                    <th>Kelas</th>
                    <th>Tugas 1 Konsep Geografi</th>
                    <th>Tugas 2 Diagram Cabang Ilmu Geografi</th>
                    <th>Tugas 3 Contoh Prinsip Geografi</th>
                    <th>Tugas 4 Perkembangan Ilmu Geografi</th>
                    <th>Catatan Dasar Geografi</th>
                    <th>Sumatif harian 1 Dasar Geografi</th>
                    <th>Tugas 5 Analisis Komponen Peta Topografi dan Persebaran Industri</th>
                    <th>Tugas 6 Menghitung Skala Peta</th>
                    <th>Tugas 7 Menghitung Skala Foto Udara</th>
                    <th>Tugas 8 Manfaat SIG</th>
                    <th>Catatan Peta, Pengindraan Jauh, SIG</th>
                    <th>Sumatif harian 2 Peta PJ SIG</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
</div>

<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ5-YH4IRwxf6aAIG6zyT_XFa-CD9ev60Bs0iF_GZ60aovblWb2LMdtZCkpKYs_DOxG7xciQmROdfYN/pub?gid=772414065&single=true&output=csv";
const validNISN = [
    "0097758369",
    "0097931054",
    "0093693520",
    "0103307505",
    "0102108205",
    "0102371225",
    "0094238385"
];

let dataCache = [];

async function loadData() {
    const res = await fetch(SHEET_URL);
    const csv = await res.text();
    const rows = csv.split("\n").map(r => r.split(","));
    const headers = rows[0];
    const data = rows.slice(1).map(row => {
        let obj = {};
        headers.forEach((h, i) => obj[h.trim()] = row[i] ? row[i].trim() : "");
        return obj;
    });
    dataCache = data;
}

async function login() {
    const nisn = document.getElementById("nisnInput").value.trim();
    const errorMsg = document.getElementById("loginError");

    if (!validNISN.includes(nisn)) {
        errorMsg.style.display = "block";
        return;
    }

    errorMsg.style.display = "none";

    if (dataCache.length === 0) await loadData();

    const siswaData = dataCache.filter(row => row["NISN"] === nisn);

    if (siswaData.length === 0) {
        alert("Data nilai tidak ditemukan untuk NISN ini.");
        return;
    }

    document.getElementById("loginBox").classList.add("hidden");
    document.getElementById("reportBox").classList.remove("hidden");

    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";

    siswaData.forEach(row => {
        const tr = document.createElement("tr");
        [
            "NISN",
            "NAMA",
            "KELAS",
            "Tugas 1 Konsep Geografi",
            "Tugas 2 Diagram Cabang Ilmu Geografi",
            "Tugas 3 Contoh Prinsip Geografi",
            "Tugas 4 Perkembangan Ilmu Geografi",
            "Catatan Dasar Geografi",
            "Sumatif harian 1 Dasar Geografi",
            "Tugas 5 Analisis Komponen Peta Topografi dan Persebaran Industri",
            "Tugas 6 Menghitung Skala Peta",
            "Tugas 7 Menghitung Skala Foto Udara",
            "Tugas 8 Manfaat SIG",
            "Catatan Peta, Pengindraan Jauh, SIG",
            "Sumatif harian 2 Peta PJ SIG"
        ].forEach(col => {
            const td = document.createElement("td");
            td.textContent = row[col] || "";
            tr.appendChild(td);
        });
        tbody.appendChild(tr);
    });
}

function logout() {
    document.getElementById("reportBox").classList.add("hidden");
    document.getElementById("loginBox").classList.remove("hidden");
    document.getElementById("nisnInput").value = "";
}
</script>
</body>
</html>
